<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">

	<title>Title Goes Here</title>
    <style>
        canvas {
            border: 1px solid;
        }
    </style>
</head>

<body>
<canvas id="myCanvas" width="800" height="400"></canvas>
<script type="text/javascript">
    (function() {

    console.log('start');
    var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");

    var first_line = {
        x: 100,
        y: 100,
        theta: 0, // radians
        radius: 30,
        angular_vel: 0
    };

    var draw_circle = function(x, y, r) {
        ctx.beginPath();
        ctx.arc(x, y, r,0,2*Math.PI);
        ctx.stroke();
    };

    var draw_line = function(line) {
        ctx.beginPath();
        ctx.moveTo(line.x, line.y);
        var x2 = line.x + line.radius * Math.cos(line.theta);
        var y2 = line.y + line.radius * Math.sin(line.theta);
        ctx.lineTo(x2, y2);
        ctx.stroke();
        draw_circle(x2, y2, 5);

        draw_circle(line.x, line.y, line.radius);
    };

    var get_line_angular_acceleration = function(line, force, mom_inertia) {
        // due to mass
        var t1 = force * line.radius * Math.cos(line.theta);
        // due to ramp
        var ramp_force = 1; // TODO do something here
        var t2 = 4;
        // var t2 = ramp_force * line.radius * Math.cos(-3.0/4 * Math.PI);
        return (t1 + t2) / mom_inertia;
    }

    var clear_canvas = function() {
        ctx.clearRect (0, 0, 800, 400);
    };

    var FRAME_TIME_DELTA = .03; // in s

    var next_frame = function() {
        alpha = get_line_angular_acceleration(first_line, .2, 1);
        first_line.angular_vel = first_line.angular_vel + alpha * FRAME_TIME_DELTA;
        var theta_change = first_line.angular_vel * FRAME_TIME_DELTA;
        first_line.theta = first_line.theta + theta_change;

        first_line.x = first_line.x + first_line.radius * theta_change;

        clear_canvas();
        draw_line(first_line);
    }

    setInterval(next_frame, FRAME_TIME_DELTA * 1000); // just for now


    })();
</script>
</body>
</html>


